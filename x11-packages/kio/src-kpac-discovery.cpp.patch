diff -uNr a/src/kpac/discovery.cpp b/src/kpac/discovery.cpp
--- a/src/kpac/discovery.cpp	2023-01-12 07:48:26.000000000 +0900
+++ b/src/kpac/discovery.cpp	2023-02-07 04:02:21.534196020 +0900
@@ -79,13 +79,11 @@
     unsigned char *end = response.buf + len;
 
     // skip query section
-    pos += dn_skipname(pos, end) + QFIXEDSZ;
     if (pos >= end) {
         return true;
     }
 
     // skip answer domain
-    pos += dn_skipname(pos, end);
     short type;
     GETSHORT(type, pos);
     return type != T_SOA;
